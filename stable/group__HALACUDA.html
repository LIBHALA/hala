<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HALA: Handy Accelerated Linear Algebra v1.0: HALA CUDA Wrapper Templates</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="hala.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
    <div class="doxygen">
            <a href="http://www.doxygen.org/index.html">
                <img class="footer" src="doxygen.png" alt="doxygen"/>
                </a> 1.8.13
    </div>
   <div id="projectname">HALA: Handy Accelerated Linear Algebra v1.0
   <!--         <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
 -->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__HALACUDA.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">HALA CUDA Wrapper Templates</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:hala__cuda_8hpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hala__cuda_8hpp.html">hala_cuda.hpp</a></td></tr>
<tr class="memdesc:hala__cuda_8hpp"><td class="mdescLeft">&#160;</td><td class="mdescRight">HALA wrapper for CUDA functions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section user"><dt>CUDA Wrapper Templates</dt><dd>A set of templates that wrap around CUDA functions allowing for (near) seamless generalization of linear algebra code written for the CPU version of BLAS to be instantiated and used with cuBlas and cuSparse libraries.</dd></dl>
<dl class="section user"><dt>CUDA Vector</dt><dd>HALA provides a CUDA vector class that mimics the container structure of <b>std::vector</b> but wraps around a raw-pointer holding data on a CUDA device. The use of the hala::cuda_vector is optional, since all HALA templates work with general vector-like classes; however, it is handy and fully compatible with the C++ standards (unlike CUDA thrust) and doesn't require third party support. The hala::cuda_vector is also the default internal vector for the hala::cuda_engine.</dd></dl>
<dl class="section user"><dt>CUDA Engine</dt><dd>Unlike the <a class="el" href="structhala_1_1cpu__engine.html" title="The CPU Engine. ">hala::cpu_engine</a> class that is simply a collection of handy methods, the hala::cuda_engine has internal state, namely the cuBlas and cuSparse handles and the ID of the associated CUDA device. The CPU version of BLAS accepts all scalars by value; however, CUDA libraries can work with pointers on either the host or the device. The hala::cuda_engine defaults to using points on the host which allows for the HALA-CUDA template-wrappers to have identical signature to HALA-BLAS; however, the template can also accept scalars passed in as pointers and the hala::cuda_engine can be used to specify the host/device mode. See also hala::cuda_pntr.</dd></dl>
<dl class="section user"><dt>cuBlas Wrappers</dt><dd>The cuBlas library provides an almost complete implementation of the BLAS standard but using a CUDA device. HALA provides a complete set of BLAS overloads that have identical signature and the CPU and GPU (with the additional engine variable). The areas where cuBlas deviates from the standard will result in performance penalty, but the results will always be correct. Here are the cases where that matters:<ul>
<li>The symmetric banded method sbmv does not have a CUDA implementation for the non-conjugate mode, the HALA work-around uses the CPU implementation with data being moved between the CPU and the GPU and hence suffering a performance penalty (but giving the correct results).</li>
<li>The packed methods spmv, spr and spr2 do not have native implementation for the symmetric non-conjugate case, while the methods will work they will involve packing and unpacking which will affect performance.</li>
<li>The cuBlas implementation of triangular matrix-matrix multiply trmm does not overwrite the input matrix B but outputs the result in another matrix C; HALA will copy the output over to maintain a consistent API but there is the additional cost of the copy at the background.</li>
<li>The HALA implementation of the Givens rotation generation uses BLAS, after all it is setting a 2x2 matrix with a few scalars, the cost is hardly worth the attention of the GPU.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>cuSparse Wrappers</dt><dd>The cuSparse library overs a large set of methods for handling sparse matrices, but the API is very cumbersome and hard to use. Many methods, especially in the newer API, use opaque C-style structures to wrap around the data and those structures have to be manually created and destroyed. Almost every call to cuSparse requires the additional workspace vector to be manually allocated (and later deleted). Triangular solve methods require additional analysis steps that look for ways to optimize the solve phase, each analysis is stored in yet another opaque C-style structure.</dd></dl>
<dl class="section user"><dt></dt><dd>HALA provides wrappers that automatically handle the many cuSparse API calls and data-structures, and provide an API that is no harder to use than the standard BLAS methods. In addition, HALA provides wrapper triangular matrix classes that automatically handle the matrix analysis without sacrificing generality. Similar wrappers are provided around the cuSparse incomplete lower-upper preconditioner methods. </dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<!-- <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<!--  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div> -->
</body>
</html>
