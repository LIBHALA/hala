<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HALA: Handy Accelerated Linear Algebra v1.0: GMRES Solver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="hala.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
    <div class="doxygen">
            <a href="http://www.doxygen.org/index.html">
                <img class="footer" src="doxygen.png" alt="doxygen"/>
                </a> 1.8.13
    </div>
   <div id="projectname">HALA: Handy Accelerated Linear Algebra v1.0
   <!--         <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
 -->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__HALASOLVEGMRES.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">GMRES Solver<div class="ingroups"><a class="el" href="group__HALASOLVERS.html">HALA Solver Algorithms</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for GMRES Solver:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__HALASOLVEGMRES.png" border="0" alt="" usemap="#group____HALASOLVEGMRES"/>
<map name="group____HALASOLVEGMRES" id="group____HALASOLVEGMRES">
<area shape="rect" id="node2" href="group__HALASOLVERS.html" title="HALA Solver Algorithms" alt="" coords="5,5,169,32"/>
</map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2f596d6e84d3c048023b11c6d56a0a1f"><td class="memTemplParams" colspan="2">template&lt;class compute_engine , class VectorLikeP , class VectorLikeI , class VectorLikeV , class VectorLikeX , class VectorLikeB &gt; </td></tr>
<tr class="memitem:ga2f596d6e84d3c048023b11c6d56a0a1f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacehala.html#acb09081de2bccbc9add2b253d4793368">hala_int</a>&lt; compute_engine &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__HALASOLVEGMRES.html#ga2f596d6e84d3c048023b11c6d56a0a1f">hala::solve_gmres</a> (compute_engine const &amp;engine, <a class="el" href="structhala_1_1stop__criteria.html">stop_criteria</a>&lt; <a class="el" href="group__HALACUSTOM.html#ga78609b70f45312e08e520b6ed736ff40">get_precision_type</a>&lt; VectorLikeV &gt;&gt; const &amp;stop, int restart, VectorLikeP const &amp;pntr, VectorLikeI const &amp;indx, VectorLikeV const &amp;vals, <a class="el" href="group__HALASOLVERS.html#ga4e42c8118b1a08628124f28874d411cf">preconditioner</a>&lt; compute_engine, VectorLikeV &gt; precon, VectorLikeB const &amp;b, VectorLikeX &amp;x)</td></tr>
<tr class="memdesc:ga2f596d6e84d3c048023b11c6d56a0a1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">General restarted preconditioned Minimum RESidula (GMRES) method, base template.  <a href="group__HALASOLVEGMRES.html#ga2f596d6e84d3c048023b11c6d56a0a1f">More...</a><br /></td></tr>
<tr class="separator:ga2f596d6e84d3c048023b11c6d56a0a1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1cd7fcc796fad467b62159e72a1ca792"><td class="memTemplParams" colspan="2">template&lt;class compute_engine , class VectorLikeP , class VectorLikeI , class VectorLikeV , class ILUclass , class VectorLikeX , class VectorLikeB &gt; </td></tr>
<tr class="memitem:ga1cd7fcc796fad467b62159e72a1ca792"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacehala.html#acb09081de2bccbc9add2b253d4793368">hala_int</a>&lt; compute_engine &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__HALASOLVEGMRES.html#ga1cd7fcc796fad467b62159e72a1ca792">hala::solve_gmres_ilu</a> (compute_engine const &amp;engine, <a class="el" href="structhala_1_1stop__criteria.html">stop_criteria</a>&lt; <a class="el" href="group__HALACUSTOM.html#ga78609b70f45312e08e520b6ed736ff40">get_precision_type</a>&lt; VectorLikeV &gt;&gt; const &amp;stop, int restart, VectorLikeP const &amp;pntr, VectorLikeI const &amp;indx, VectorLikeV const &amp;vals, ILUclass const &amp;ilu, VectorLikeB const &amp;b, VectorLikeX &amp;x)</td></tr>
<tr class="memdesc:ga1cd7fcc796fad467b62159e72a1ca792"><td class="mdescLeft">&#160;</td><td class="mdescRight">General restarted Minimum RESidula (GMRES) method with ILU preconditioner.  <a href="group__HALASOLVEGMRES.html#ga1cd7fcc796fad467b62159e72a1ca792">More...</a><br /></td></tr>
<tr class="separator:ga1cd7fcc796fad467b62159e72a1ca792"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>A series of templates that implement the preconditioned General Minimum RESidual method with several options to choose from different preconditioners. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga2f596d6e84d3c048023b11c6d56a0a1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f596d6e84d3c048023b11c6d56a0a1f">&#9670;&nbsp;</a></span>solve_gmres()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class compute_engine , class VectorLikeP , class VectorLikeI , class VectorLikeV , class VectorLikeX , class VectorLikeB &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacehala.html#acb09081de2bccbc9add2b253d4793368">hala_int</a>&lt;compute_engine&gt; hala::solve_gmres </td>
          <td>(</td>
          <td class="paramtype">compute_engine const &amp;&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhala_1_1stop__criteria.html">stop_criteria</a>&lt; <a class="el" href="group__HALACUSTOM.html#ga78609b70f45312e08e520b6ed736ff40">get_precision_type</a>&lt; VectorLikeV &gt;&gt; const &amp;&#160;</td>
          <td class="paramname"><em>stop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>restart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeP const &amp;&#160;</td>
          <td class="paramname"><em>pntr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeI const &amp;&#160;</td>
          <td class="paramname"><em>indx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeV const &amp;&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__HALASOLVERS.html#ga4e42c8118b1a08628124f28874d411cf">preconditioner</a>&lt; compute_engine, VectorLikeV &gt;&#160;</td>
          <td class="paramname"><em>precon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeB const &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeX &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>General restarted preconditioned Minimum RESidula (GMRES) method, base template. </p>
<p>Solves \( P^{-1} A x = P^{-1} b \) using the GMRES method for general non-singular matrices. Compared to the Conjugate-Gradient method, GMRES handles much more general problems but comes at the additional cost of explicitly storing the Krylov basis.</p><ul>
<li><b>engine</b> is the compute engine associated with the matrix and input vectors</li>
<li><b>stop</b> defines the tolerance (measured as the norm of the residual) and the maximum number of (outer) iterations</li>
<li><b>restart</b> is the maximum size of the Krylov basis after which the method will restart with the current solution as a new initial guess;</li>
<li><b>pntr</b>, <b>indx</b>, and <b>vals</b> describe a sparse matrix in row-compressed format</li>
<li><b>precon</b> is a preconditioner associated either with the <a class="el" href="structhala_1_1cpu__engine.html" title="The CPU Engine. ">cpu_engine</a> or the <a class="el" href="structhala_1_1gpu__engine.html" title="Core engine class, deals with handles and data transfer. ">gpu_engine</a>, when using the mixed_engine the preconditioner accepts vectors on the GPU</li>
<li><b>b</b> is the right hand side</li>
<li><b>x</b> is the initial iterate and the final solution, if the size of <b>x</b> is insufficient it will be resized and set to zero</li>
<li><b>returns</b> the total number of matrix-vector-preconditioner applications</li>
</ul>
<p><b>Restart</b> frequency should be balanced, since frequent restarts will deteriorate the convergence but larger basis is expensive to store and manipulate. The Krylov basis has size equal to the number of basis vectors times the number of rows of the matrix.</p>
<p>Overloads: </p><div class="fragment"><div class="line"><a class="code" href="group__HALASOLVEGMRES.html#ga2f596d6e84d3c048023b11c6d56a0a1f">solve_gmres</a>(stop, restart, pntr, indx, vals, precon, b, x);</div><div class="line"><a class="code" href="group__HALASOLVEGMRES.html#ga2f596d6e84d3c048023b11c6d56a0a1f">solve_gmres</a>(engine, stop, restart, pntr, indx, vals, precon, b, x);</div></div><!-- fragment --><p> The method can be called with any compute engine and no engine, the type of the <b>precon</b> function changes accordingly, see <a class="el" href="group__HALASOLVERS.html#ga4e42c8118b1a08628124f28874d411cf" title="Type that describes the preconditioner for an iterative solver, engine case. ">hala::preconditioner</a> and <a class="el" href="group__HALASOLVERS.html#ga79e339da4158ec79ddcfae6317588390" title="Type that describes the preconditioner for an iterative solver, no-engine case. ">hala::preconditioner_noe</a>.</p>

</div>
</div>
<a id="ga1cd7fcc796fad467b62159e72a1ca792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1cd7fcc796fad467b62159e72a1ca792">&#9670;&nbsp;</a></span>solve_gmres_ilu()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class compute_engine , class VectorLikeP , class VectorLikeI , class VectorLikeV , class ILUclass , class VectorLikeX , class VectorLikeB &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacehala.html#acb09081de2bccbc9add2b253d4793368">hala_int</a>&lt;compute_engine&gt; hala::solve_gmres_ilu </td>
          <td>(</td>
          <td class="paramtype">compute_engine const &amp;&#160;</td>
          <td class="paramname"><em>engine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhala_1_1stop__criteria.html">stop_criteria</a>&lt; <a class="el" href="group__HALACUSTOM.html#ga78609b70f45312e08e520b6ed736ff40">get_precision_type</a>&lt; VectorLikeV &gt;&gt; const &amp;&#160;</td>
          <td class="paramname"><em>stop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>restart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeP const &amp;&#160;</td>
          <td class="paramname"><em>pntr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeI const &amp;&#160;</td>
          <td class="paramname"><em>indx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeV const &amp;&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ILUclass const &amp;&#160;</td>
          <td class="paramname"><em>ilu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeB const &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorLikeX &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>General restarted Minimum RESidula (GMRES) method with ILU preconditioner. </p>
<p>Calls <a class="el" href="group__HALASOLVEGMRES.html#ga2f596d6e84d3c048023b11c6d56a0a1f" title="General restarted preconditioned Minimum RESidula (GMRES) method, base template. ">hala::solve_gmres()</a> using the ILU preconditioner <b>ilu</b>. The preconditioner has to be associated with the compute engine (e.g., mixed preconditioner for the mixed_engine), the ILU preconditioner must also match the engine for the vector in the no-engine case (e.g., <a class="el" href="structhala_1_1engined__vector.html" title="A struct that binds an engine and a vector so both can be carried in one context. ...">hala::engined_vector</a>).</p>
<p>Overloads: </p><div class="fragment"><div class="line"><a class="code" href="group__HALASOLVEGMRES.html#ga1cd7fcc796fad467b62159e72a1ca792">solve_gmres_ilu</a>(stop, restart, pntr, indx, vals, b, x);</div><div class="line"><a class="code" href="group__HALASOLVEGMRES.html#ga1cd7fcc796fad467b62159e72a1ca792">solve_gmres_ilu</a>(stop, restart, pntr, indx, vals, ilu, b, x);</div><div class="line"><a class="code" href="group__HALASOLVEGMRES.html#ga1cd7fcc796fad467b62159e72a1ca792">solve_gmres_ilu</a>(engine, stop, restart, pntr, indx, vals, b, x);</div><div class="line"><a class="code" href="group__HALASOLVEGMRES.html#ga1cd7fcc796fad467b62159e72a1ca792">solve_gmres_ilu</a>(engine, stop, restart, pntr, indx, vals, ilu, b, x);</div></div><!-- fragment --><p> If the ILU is not provided, factorization will be computed, used and finally discarded on-the-fly. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<!-- <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<!--  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div> -->
</body>
</html>
